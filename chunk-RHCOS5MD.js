import{a as k}from"./chunk-UMVH7XMK.js";import{a as E}from"./chunk-UWJMY7QB.js";import{b as V}from"./chunk-MHANH5UQ.js";import{a as g,b as d}from"./chunk-3UPHS55R.js";import{j as M}from"./chunk-BGIOPOK4.js";import{a as T}from"./chunk-LZO44IQN.js";import{$a as C,$b as A,C as u,Cb as O,Gc as m,Hb as j,Ib as x,Pb as D,T as l,_ as R,_b as w,ea as n,g as $,ia as v,jc as I,kb as b,m as o,sb as y,za as h}from"./chunk-4LMCG722.js";import{a,b as c}from"./chunk-A43TDCY5.js";var S="/api/route",G=(()=>{let i=class i{constructor(){this.httpClient=n(T),this.destroyRef=n(h),this.stationsService=n(k),this.carriageService=n(E),this.$$routes=new $([]),this.$routes=this.$$routes.asObservable(),this.getAllRoutes().pipe(g(this.destroyRef)).subscribe();let e=d(this.$$routes,{initialValue:[]});this.stationsSig=d(this.stationsService.$stations,{initialValue:[]}),this.carriagesSig=d(this.carriageService.$carriages,{initialValue:[]}),this.stationsObjSig=m(()=>this.stationsSig().reduce((t,r)=>c(a({},t),{[r.id]:r}),{})),this.carriagesObjSig=m(()=>this.carriagesSig().reduce((t,r)=>c(a({},t),{[r.code]:r}),{})),this.combinedSignal=m(()=>{let t=e(),r=this.stationsObjSig(),F=this.carriagesObjSig();return t.map(f=>({id:f.id,path:f.path.map(p=>r[p]??{id:0,city:"",latitude:"",longitude:""}),carriages:f.carriages.map(p=>F[p]??{code:p,name:"",rows:1,leftSeats:1,rightSeats:1})}))})}getAllRoutes(){return this.httpClient.get(S).pipe(l(e=>(this.$$routes.next(e),o({status:0,error:null}))),u(({error:e})=>o({status:1,error:e})))}postRoute(e){return this.httpClient.post(S,e).pipe(l(t=>(this.$$routes.next([...this.$$routes.getValue(),c(a({},e),{id:t.id})]),o({status:0,error:null}))),u(({error:t})=>o({status:1,error:t})))}putRoute(e,t){return this.httpClient.put(`${S}/${t}`,e).pipe(l(()=>(this.$$routes.next([...this.$$routes.getValue().map(r=>r.id===t?c(a({},e),{id:t}):r)]),o({status:0,error:null}))),u(({error:r})=>o({status:1,error:r})))}deleteRoute(e){return this.httpClient.delete(`/api/route/${e}`).pipe(l(()=>{let t=this.$$routes.value.filter(r=>r.id!==e);return this.$$routes.next(t),o({status:0,error:null})}),u(({error:t})=>o({status:1,error:t})))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=R({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})();function _(s,i){if(s&1&&(j(0,"span"),w(1),x()),s&2){let U=D();C(),A(U.error())}}var et=(()=>{let i=class i{constructor(){this.control=n(M,{self:!0}),this.errors=n(V),this.destroyRef=n(h),this.error=b(""),this.control.valueAccessor=this}ngOnInit(){this.control.control?.events.pipe(g(this.destroyRef)).subscribe(()=>{if(this.control.name&&this.control.errors){let t=Object.keys(this.control.errors)?.[0],r=this.errors[t]||"Unknown error occurred";this.error.set(r)}else this.error.set("")})}writeValue(){}registerOnChange(){}registerOnTouched(){}setDisabledState(){}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=v({type:i,selectors:[["app-array-control-error-message"]],standalone:!0,features:[I],decls:1,vars:1,template:function(t,r){t&1&&y(0,_,2,1,"span"),t&2&&O(r.error()?0:-1)}});let s=i;return s})();export{G as a,et as b};
