import{a as w}from"./chunk-ZJVFCZDK.js";import{a as S}from"./chunk-EXNCYKD7.js";import{B as a,S as u,Z as f,ca as g,da as d,g as m,l as n,ya as $}from"./chunk-JLXU3JPY.js";import{a as p,b as h}from"./chunk-A43TDCY5.js";var i=function(t){return t.Signup="/api/signup",t.Signin="/api/signin",t.Logout="/api/logout",t}(i||{}),l=function(t){return t.Profile="/api/profile",t}(l||{});var R=(()=>{let s=class s{constructor(e){this.httpClient=e,this.destroyRef=d($),this.$$authStatus=new m({token:localStorage.getItem("rsToken")||null,success:!1,error:null,role:null}),this.$authStatus=this.$$authStatus.asObservable(),this.$$authStatus.getValue().token&&this.getRole().pipe(w(this.destroyRef)).subscribe()}signUp(e){return this.httpClient.post(i.Signup,e).pipe(u(()=>this.signIn(e)),a(({error:r})=>(this.$$authStatus.next({token:null,success:!1,error:r.message,role:null}),n({status:1,error:r}))))}signIn(e){return this.cleanToken(),this.httpClient.post(i.Signin,e).pipe(u(r=>(this.$$authStatus.next({token:r.token,success:!0,error:null,role:null}),localStorage.setItem("rsToken",r.token),this.getRole())),a(r=>{let{error:c}=r;return this.$$authStatus.next({token:null,success:!1,error:c.message,role:null}),n({status:1,error:c})}))}getRole(){return this.httpClient.get(l.Profile).pipe(u(e=>{let r=h(p({},this.$$authStatus.getValue()),{role:e.role});return this.$$authStatus.next(r),n({status:0,error:null})}),a(({error:e})=>(this.$$authStatus.next({token:null,success:!1,error:e.message,role:null}),n({status:1,error:e}))))}logOut(){this.httpClient.delete(i.Logout),this.cleanToken()}cleanToken(){this.$$authStatus.next({token:null,success:!1,error:null,role:null}),localStorage.removeItem("rsToken")}};s.\u0275fac=function(r){return new(r||s)(g(S))},s.\u0275prov=f({token:s,factory:s.\u0275fac,providedIn:"root"});let t=s;return t})();var j={email:{email:"Incorrect email",pattern:"Incorrect email",required:"Email is required",emailDuplicateValidate:"Account with this email already exists",userNotFound:"Incorrect email or password"},password:{required:"Password is required",minlength:"Password must be at least 8 characters long",userNotFound:"Incorrect email or password"},confirmPassword:{required:"Please repeat the password",mismatch:"Passwords do not match"}};function D(t,s){return o=>(t&&s&&"form"in t&&t.form.get(s)?.updateValueAndValidity(),o.value&&o.value.trim?.().length<8?{minlength:!0}:null)}function E(t){return s=>{if("form"in t){let o=t.form,e=o.get("password")?.value,r=o.get("confirmPassword")?.value;if(s.value&&e!==r)return{mismatch:!0}}return null}}function M(t){return t.value&&!t.value.trim?.().length?{required:!0}:null}export{D as a,E as b,M as c,i as d,R as e,j as f};
