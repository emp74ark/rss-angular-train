import{a as ee,d as D}from"./chunk-DA3KNJXH.js";import"./chunk-GCE5G2R5.js";import{a as se,c as me,d as pe,e as ce,f as ue,g as de,h as j}from"./chunk-HIZNMLD4.js";import{b as te}from"./chunk-ITMHO7LG.js";import{c as Y}from"./chunk-SAVJUPJR.js";import"./chunk-2GUOSTCV.js";import"./chunk-WPIRW2QU.js";import{a as V,c as T,d as re}from"./chunk-B3XRRNEZ.js";import{b as I,c as U,d as oe,g as O,i as G}from"./chunk-LOJTBKOL.js";import{c as ne,d as ae,e as le}from"./chunk-VJBOIVAD.js";import"./chunk-RGNDWIHZ.js";import{A as y,f as w,g as h,i as F,j as P,o as Z,q as N,s as $,y as k}from"./chunk-7OYOML3X.js";import{a as X,da as R,ha as ie}from"./chunk-PH5NDWNK.js";import{$a as s,$b as H,C as x,Cb as L,Hb as t,Ib as r,Jb as d,Kb as _,Nb as p,Pb as u,W as S,_ as z,_b as a,ac as Q,da as J,ea as c,g as A,hc as b,ia as E,ic as M,jc as W,m as v,sa as C,ta as g,ub as q,wb as f,zb as K}from"./chunk-VN6HQHAM.js";import"./chunk-A43TDCY5.js";var he=(()=>{let i=class i{constructor(o){this.httpClient=o,this.$$profile=new A(null),this.$profile=this.$$profile.asObservable(),this.$$apiStatus=new A({success:!1,error:null}),this.$apiStatus=this.$$apiStatus.asObservable()}loadProfile(){return this.httpClient.get("/api/profile").pipe(S(o=>{this.$$profile.next(o),this.$$apiStatus.next({success:!0,error:null})}),x(({error:o})=>(this.$$apiStatus.next({success:!1,error:o.message}),v(o))))}updateProfile(o){return this.httpClient.put("/api/profile",o).pipe(S(e=>{this.$$profile.next(e),this.$$apiStatus.next({success:!0,error:null})}),x(({error:e})=>(this.$$apiStatus.next({success:!1,error:e.message}),v(e))))}updatePassword(o){return this.httpClient.put("/api/profile/password",o).pipe(S(()=>{this.$$apiStatus.next({success:!0,error:null})}),x(({error:e})=>(this.$$apiStatus.next({success:!1,error:e.message}),v(e))))}};i.\u0275fac=function(e){return new(e||i)(J(X))},i.\u0275prov=z({token:i,factory:i.\u0275fac,providedIn:"root"});let n=i;return n})();var _e=()=>({padding:"10px"}),Ce=(()=>{let i=class i{constructor(){this.fb=c(k),this.dialogRef=c(se),this.passwordForm=this.fb.group({password:["",[h.required,ee()]]})}savePassword(){this.passwordForm.valid&&this.dialogRef.close(this.passwordForm.value)}closeModal(){this.dialogRef.close()}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=E({type:i,selectors:[["app-password-modal"]],standalone:!0,features:[b([{provide:V,useValue:D}]),M],decls:15,vars:4,consts:[["mat-dialog-title",""],[3,"formGroup"],["appearance","outline"],["matInput","","type","password","formControlName","password"],["formControlName","password"],["mat-button","","mat-dialog-close","",3,"click"],["mat-raised-button","","color","primary",3,"click"]],template:function(e,m){e&1&&(t(0,"h2",0),a(1,"Change Password"),r(),t(2,"mat-dialog-content")(3,"form",1)(4,"mat-form-field",2)(5,"mat-label"),a(6,"New Password"),r(),d(7,"input",3),t(8,"mat-error"),d(9,"app-form-error-message",4),r()()()(),t(10,"mat-dialog-actions")(11,"button",5),p("click",function(){return m.closeModal()}),a(12,"Cancel"),r(),t(13,"button",6),p("click",function(){return m.savePassword()}),a(14,"Save"),r()()),e&2&&(s(3),f("formGroup",m.passwordForm),s(),K(W(3,_e)))},dependencies:[j,pe,ce,de,ue,O,I,R,G,U,y,Z,w,F,P,N,$,T]});let n=i;return n})();function ve(n,i){if(n&1){let l=_();t(0,"mat-form-field",6)(1,"mat-label"),a(2,"Edit Name"),r(),d(3,"input",7),t(4,"mat-error"),d(5,"app-form-error-message",8),r()(),t(6,"button",9),p("click",function(){C(l);let e=u();return g(e.saveProfile())}),t(7,"mat-icon"),a(8,"save"),r()()}if(n&2){let l=u();s(3),f("value",l.profileForm.value.name)}}function xe(n,i){if(n&1){let l=_();t(0,"div",6)(1,"mat-label"),a(2,"Name"),r(),t(3,"p"),a(4),r()(),t(5,"button",10),p("click",function(){C(l);let e=u();return g(e.toggleEditName())}),t(6,"mat-icon"),a(7,"edit"),r()()}if(n&2){let l=u();s(4),H(l.profileForm.value.name)}}function Se(n,i){if(n&1){let l=_();t(0,"mat-form-field",6)(1,"mat-label"),a(2,"Edit Email"),r(),d(3,"input",11),t(4,"mat-error"),d(5,"app-form-error-message",12),r()(),t(6,"button",9),p("click",function(){C(l);let e=u();return g(e.saveProfile())}),t(7,"mat-icon"),a(8,"save"),r()()}if(n&2){let l=u();s(3),f("value",l.profileForm.value.email)}}function Ee(n,i){if(n&1){let l=_();t(0,"div",6)(1,"mat-label"),a(2,"Email"),r(),t(3,"p"),a(4),r()(),t(5,"button",10),p("click",function(){C(l);let e=u();return g(e.toggleEditEmail())}),t(6,"mat-icon"),a(7,"edit"),r()()}if(n&2){let l=u();s(4),H(l.profileForm.value.email)}}var tt=(()=>{let i=class i{constructor(){this.fb=c(k),this.profileService=c(he),this.authService=c(te),this.router=c(Y),this.dialog=c(me),this.role="",this.profileForm=this.fb.group({name:["",h.required],email:["",[h.required,h.email]]}),this.isEditName=!1,this.isEditEmail=!1}ngOnInit(){this.profileService.loadProfile().subscribe(o=>{o&&(this.profileForm.patchValue({name:o.name,email:o.email}),this.role=o.role)})}saveProfile(){this.profileForm.valid&&(this.profileService.updateProfile(this.profileForm.value).subscribe(),this.isEditName=!1,this.isEditEmail=!1)}toggleEditName(){this.isEditName=!this.isEditName}toggleEditEmail(){this.isEditEmail=!this.isEditEmail}changePassword(){this.dialog.open(Ce).afterClosed().subscribe(e=>{e&&this.profileService.updatePassword(e).subscribe()})}logout(){this.authService.logOut(),this.router.navigate(["/"])}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=E({type:i,selectors:[["app-user-profile"]],standalone:!0,features:[b([{provide:V,useValue:D}]),M],decls:18,vars:5,consts:[[1,"profile-card"],[1,"profile-title"],[1,"profile-field",3,"formGroup"],[1,"profile-actions"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","accent",3,"click"],["appearance","outline"],["matInput","","formControlName","name",3,"value"],["formControlName","name"],["mat-icon-button","","matSuffix","","color","primary",3,"click"],["mat-icon-button","","matSuffix","",3,"click"],["matInput","","formControlName","email",3,"value"],["formControlName","email"]],template:function(e,m){e&1&&(t(0,"mat-card",0)(1,"mat-card-content")(2,"mat-card-title",1)(3,"b"),a(4,"User Profile"),r()(),t(5,"p"),a(6),r(),t(7,"div",2),q(8,ve,9,1)(9,xe,8,1),r(),t(10,"div",2),q(11,Se,9,1)(12,Ee,8,1),r(),t(13,"div",3)(14,"button",4),p("click",function(){return m.logout()}),a(15,"Logout"),r(),t(16,"button",5),p("click",function(){return m.changePassword()}),a(17,"Change Password"),r()()()()),e&2&&(s(6),Q("Role: ",m.role,""),s(),f("formGroup",m.profileForm),s(),L(m.isEditName?8:9),s(2),f("formGroup",m.profileForm),s(),L(m.isEditEmail?11:12))},dependencies:[y,w,F,P,N,$,ne,le,O,G,I,j,re,R,oe,ie,ae,U,T],styles:[".profile-card[_ngcontent-%COMP%]{max-width:400px;margin:0 auto}.profile-field[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:16px}.profile-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:24px}"]});let n=i;return n})();export{tt as UserProfileComponent};
